[2025-11-25 07:44:25,197][252775] Saving configuration to experiments/train_dir/exp/config.json...
[2025-11-25 07:44:25,198][252775] Rollout worker 0 uses device cpu
[2025-11-25 07:44:25,198][252775] Rollout worker 1 uses device cpu
[2025-11-25 07:44:25,198][252775] Rollout worker 2 uses device cpu
[2025-11-25 07:44:25,198][252775] Rollout worker 3 uses device cpu
[2025-11-25 07:44:25,198][252775] Rollout worker 4 uses device cpu
[2025-11-25 07:44:25,199][252775] Rollout worker 5 uses device cpu
[2025-11-25 07:44:25,199][252775] Rollout worker 6 uses device cpu
[2025-11-25 07:44:25,199][252775] Rollout worker 7 uses device cpu
[2025-11-25 07:44:25,199][252775] In synchronous mode, we only accumulate one batch. Setting num_batches_to_accumulate to 1
[2025-11-25 07:44:25,767][252775] Using GPUs [0] for process 0 (actually maps to GPUs [0])
[2025-11-25 07:44:25,768][252775] InferenceWorker_p0-w0: min num requests: 2
[2025-11-25 07:44:25,801][252775] Starting all processes...
[2025-11-25 07:44:25,801][252775] Starting process learner_proc0
[2025-11-25 07:44:25,850][252775] Starting all processes...
[2025-11-25 07:44:25,858][252775] Starting process inference_proc0-0
[2025-11-25 07:44:25,858][252775] Starting process rollout_proc0
[2025-11-25 07:44:25,858][252775] Starting process rollout_proc1
[2025-11-25 07:44:25,858][252775] Starting process rollout_proc2
[2025-11-25 07:44:25,858][252775] Starting process rollout_proc3
[2025-11-25 07:44:25,859][252775] Starting process rollout_proc4
[2025-11-25 07:44:25,862][252775] Starting process rollout_proc5
[2025-11-25 07:44:25,862][252775] Starting process rollout_proc6
[2025-11-25 07:44:25,863][252775] Starting process rollout_proc7
[2025-11-25 07:44:27,937][253152] Worker 1 uses CPU cores [16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]
[2025-11-25 07:44:27,954][253155] Worker 4 uses CPU cores [64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
[2025-11-25 07:44:28,055][253154] Worker 2 uses CPU cores [32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47]
[2025-11-25 07:44:28,146][253158] Worker 7 uses CPU cores [112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]
[2025-11-25 07:44:28,231][253137] Using GPUs [0] for process 0 (actually maps to GPUs [0])
[2025-11-25 07:44:28,231][253137] Set environment var CUDA_VISIBLE_DEVICES to '0' (GPU indices [0]) for learning process 0
[2025-11-25 07:44:28,251][253151] Worker 0 uses CPU cores [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15]
[2025-11-25 07:44:28,252][253156] Worker 5 uses CPU cores [80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95]
[2025-11-25 07:44:28,265][253137] Num visible devices: 1
[2025-11-25 07:44:28,281][253150] Using GPUs [0] for process 0 (actually maps to GPUs [0])
[2025-11-25 07:44:28,281][253150] Set environment var CUDA_VISIBLE_DEVICES to '0' (GPU indices [0]) for inference process 0
[2025-11-25 07:44:28,292][253137] Setting fixed seed 42
[2025-11-25 07:44:28,293][253137] Using GPUs [0] for process 0 (actually maps to GPUs [0])
[2025-11-25 07:44:28,293][253137] Initializing actor-critic model on device cuda:0
[2025-11-25 07:44:28,296][253153] Worker 3 uses CPU cores [48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63]
[2025-11-25 07:44:28,307][253157] Worker 6 uses CPU cores [96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111]
[2025-11-25 07:44:28,315][253150] Num visible devices: 1
[2025-11-25 07:44:28,340][253137] Convolutional layer output size: 7744
[2025-11-25 07:44:28,618][253137] Created Actor Critic model with architecture:
[2025-11-25 07:44:28,618][253137] ActorCriticSharedWeights(
  (obs_normalizer): ObservationNormalizer()
  (encoder): ResnetEncoder(
    (conv_head): Sequential(
      (0): Conv2d(2, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): ResBlock(
        (res_block_core): Sequential(
          (0): ReLU(inplace=True)
          (1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (2): ReLU(inplace=True)
          (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
      )
      (2): ResBlock(
        (res_block_core): Sequential(
          (0): ReLU(inplace=True)
          (1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (2): ReLU(inplace=True)
          (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
      )
      (3): ResBlock(
        (res_block_core): Sequential(
          (0): ReLU(inplace=True)
          (1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (2): ReLU(inplace=True)
          (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
      )
      (4): ResBlock(
        (res_block_core): Sequential(
          (0): ReLU(inplace=True)
          (1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (2): ReLU(inplace=True)
          (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
      )
      (5): ResBlock(
        (res_block_core): Sequential(
          (0): ReLU(inplace=True)
          (1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (2): ReLU(inplace=True)
          (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
      )
      (6): ResBlock(
        (res_block_core): Sequential(
          (0): ReLU(inplace=True)
          (1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (2): ReLU(inplace=True)
          (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
      )
      (7): ResBlock(
        (res_block_core): Sequential(
          (0): ReLU(inplace=True)
          (1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (2): ReLU(inplace=True)
          (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
      )
      (8): ResBlock(
        (res_block_core): Sequential(
          (0): ReLU(inplace=True)
          (1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
          (2): ReLU(inplace=True)
          (3): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
        )
      )
      (9): ReLU(inplace=True)
    )
    (extra_linear): Sequential(
      (0): Linear(in_features=7744, out_features=512, bias=True)
      (1): ReLU(inplace=True)
    )
  )
  (core): ModelCoreRNN(
    (core): GRU(512, 256)
  )
  (decoder): MlpDecoder(
    (mlp): Identity()
  )
  (critic_linear): Linear(in_features=256, out_features=1, bias=True)
  (action_parameterization): ActionParameterizationDefault(
    (distribution_linear): Linear(in_features=256, out_features=5, bias=True)
  )
)
[2025-11-25 07:44:44,691][253137] Using optimizer <class 'torch.optim.adam.Adam'>
[2025-11-25 07:44:44,692][253137] No checkpoints found
[2025-11-25 07:44:44,692][253137] Did not load from checkpoint, starting from scratch!
[2025-11-25 07:44:44,692][253137] Initialized policy 0 weights for model version 0
[2025-11-25 07:44:44,698][253137] LearnerWorker_p0 finished initialization!
[2025-11-25 07:44:44,699][253137] Using GPUs [0] for process 0 (actually maps to GPUs [0])
[2025-11-25 07:44:45,476][253150] Convolutional layer output size: 7744
[2025-11-25 07:44:45,759][252775] Heartbeat connected on Batcher_0
[2025-11-25 07:44:45,763][252775] Heartbeat connected on LearnerWorker_p0
[2025-11-25 07:44:45,773][252775] Heartbeat connected on RolloutWorker_w0
[2025-11-25 07:44:45,777][252775] Heartbeat connected on RolloutWorker_w1
[2025-11-25 07:44:45,781][252775] Heartbeat connected on RolloutWorker_w2
[2025-11-25 07:44:45,785][252775] Heartbeat connected on RolloutWorker_w3
[2025-11-25 07:44:45,788][252775] Heartbeat connected on RolloutWorker_w4
[2025-11-25 07:44:45,793][252775] Heartbeat connected on RolloutWorker_w5
[2025-11-25 07:44:45,796][252775] Heartbeat connected on RolloutWorker_w6
[2025-11-25 07:44:45,800][252775] Heartbeat connected on RolloutWorker_w7
[2025-11-25 07:44:46,229][252775] Fps is (10 sec: nan, 60 sec: nan, 300 sec: nan). Total num frames: 0. Throughput: 0: nan. Samples: 0. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:44:51,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 0.0. Samples: 0. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:44:56,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 0.0. Samples: 0. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:45:01,078][252775] Inference worker 0-0 is ready!
[2025-11-25 07:45:01,079][252775] All inference workers are ready! Signal rollout workers to start!
[2025-11-25 07:45:01,080][252775] Heartbeat connected on InferenceWorker_p0-w0
[2025-11-25 07:45:01,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 0.0. Samples: 0. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:45:02,477][253152] Decorrelating experience for 0 frames...
[2025-11-25 07:45:02,521][253154] Decorrelating experience for 0 frames...
[2025-11-25 07:45:02,604][253157] Decorrelating experience for 0 frames...
[2025-11-25 07:45:02,605][253158] Decorrelating experience for 0 frames...
[2025-11-25 07:45:02,619][253156] Decorrelating experience for 0 frames...
[2025-11-25 07:45:02,708][253151] Decorrelating experience for 0 frames...
[2025-11-25 07:45:02,718][253153] Decorrelating experience for 0 frames...
[2025-11-25 07:45:02,775][253155] Decorrelating experience for 0 frames...
[2025-11-25 07:45:03,359][253152] Decorrelating experience for 8 frames...
[2025-11-25 07:45:03,403][253156] Decorrelating experience for 8 frames...
[2025-11-25 07:45:03,412][253154] Decorrelating experience for 8 frames...
[2025-11-25 07:45:03,493][253158] Decorrelating experience for 8 frames...
[2025-11-25 07:45:03,494][253157] Decorrelating experience for 8 frames...
[2025-11-25 07:45:03,611][253151] Decorrelating experience for 8 frames...
[2025-11-25 07:45:03,642][253153] Decorrelating experience for 8 frames...
[2025-11-25 07:45:03,706][253155] Decorrelating experience for 8 frames...
[2025-11-25 07:45:04,544][253152] Decorrelating experience for 16 frames...
[2025-11-25 07:45:04,576][253154] Decorrelating experience for 16 frames...
[2025-11-25 07:45:04,615][253158] Decorrelating experience for 16 frames...
[2025-11-25 07:45:04,631][253156] Decorrelating experience for 16 frames...
[2025-11-25 07:45:04,643][253157] Decorrelating experience for 16 frames...
[2025-11-25 07:45:04,776][253155] Decorrelating experience for 16 frames...
[2025-11-25 07:45:04,819][253153] Decorrelating experience for 16 frames...
[2025-11-25 07:45:05,010][253151] Decorrelating experience for 16 frames...
[2025-11-25 07:45:05,837][253154] Decorrelating experience for 24 frames...
[2025-11-25 07:45:05,891][253157] Decorrelating experience for 24 frames...
[2025-11-25 07:45:06,036][253158] Decorrelating experience for 24 frames...
[2025-11-25 07:45:06,046][253156] Decorrelating experience for 24 frames...
[2025-11-25 07:45:06,048][253152] Decorrelating experience for 24 frames...
[2025-11-25 07:45:06,193][253155] Decorrelating experience for 24 frames...
[2025-11-25 07:45:06,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 0.0. Samples: 0. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:45:06,259][253153] Decorrelating experience for 24 frames...
[2025-11-25 07:45:06,416][253151] Decorrelating experience for 24 frames...
[2025-11-25 07:45:11,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 0.0. Samples: 0. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:45:16,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 0.0. Samples: 0. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:45:21,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 643.7. Samples: 22528. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:45:26,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 2278.4. Samples: 91136. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:45:31,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 3299.6. Samples: 148480. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:45:35,986][253137] EvtLoop [learner_proc0_evt_loop, process=learner_proc0] unhandled exception in slot='on_new_training_batch' connected to emitter=Emitter(object_id='Batcher_0', signal_name='training_batches_available'), args=(0,)
Traceback (most recent call last):
  File "/opt/conda/envs/ltf/lib/python3.10/site-packages/signal_slot/signal_slot.py", line 355, in _process_signal
    slot_callable(*args)
  File "/opt/conda/envs/ltf/lib/python3.10/site-packages/sample_factory/algo/learning/learner_worker.py", line 150, in on_new_training_batch
    stats = self.learner.train(self.batcher.training_batches[batch_idx])
  File "/opt/conda/envs/ltf/lib/python3.10/site-packages/sample_factory/algo/learning/learner.py", line 1036, in train
    buff, experience_size, num_invalids = self._prepare_batch(batch)
  File "/opt/conda/envs/ltf/lib/python3.10/site-packages/sample_factory/algo/learning/learner.py", line 960, in _prepare_batch
    next_values = self.actor_critic(normalized_last_obs, buff["rnn_states"][:, -1], values_only=True)["values"]
  File "/opt/conda/envs/ltf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/envs/ltf/lib/python3.10/site-packages/sample_factory/model/actor_critic.py", line 179, in forward
    x = self.forward_head(normalized_obs_dict)
  File "/opt/conda/envs/ltf/lib/python3.10/site-packages/sample_factory/model/actor_critic.py", line 155, in forward_head
    x = self.encoder(normalized_obs_dict)
  File "/opt/conda/envs/ltf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/workspcace/exp/2511mapf/learn_to_follow/follower/model.py", line 127, in forward
    x = self.conv_head(x)
  File "/opt/conda/envs/ltf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/envs/ltf/lib/python3.10/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/opt/conda/envs/ltf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/opt/conda/envs/ltf/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/opt/conda/envs/ltf/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 968.00 MiB (GPU 0; 79.15 GiB total capacity; 637.31 MiB already allocated; 5.88 MiB free; 660.00 MiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2025-11-25 07:45:35,988][253137] Unhandled exception CUDA out of memory. Tried to allocate 968.00 MiB (GPU 0; 79.15 GiB total capacity; 637.31 MiB already allocated; 5.88 MiB free; 660.00 MiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF in evt loop learner_proc0_evt_loop
[2025-11-25 07:45:36,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 5529.6. Samples: 248832. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:45:41,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 5825.4. Samples: 262144. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:45:46,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 5825.4. Samples: 262144. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:45:51,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 5825.4. Samples: 262144. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:45:56,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 5825.4. Samples: 262144. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:46:01,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 5825.4. Samples: 262144. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:46:06,229][252775] Fps is (10 sec: 0.0, 60 sec: 0.0, 300 sec: 0.0). Total num frames: 0. Throughput: 0: 5324.8. Samples: 262144. Policy #0 lag: (min: -1.0, avg: -1.0, max: -1.0)
[2025-11-25 07:46:10,700][252775] Keyboard interrupt detected in the event loop EvtLoop [Runner_EvtLoop, process=main process 252775], exiting...
[2025-11-25 07:46:10,702][252775] Runner profile tree view:
main_loop: 104.9015
[2025-11-25 07:46:10,702][253137] Stopping Batcher_0...
[2025-11-25 07:46:10,702][253155] Stopping RolloutWorker_w4...
[2025-11-25 07:46:10,702][253154] Stopping RolloutWorker_w2...
[2025-11-25 07:46:10,702][253157] Stopping RolloutWorker_w6...
[2025-11-25 07:46:10,702][253151] Stopping RolloutWorker_w0...
[2025-11-25 07:46:10,702][253152] Stopping RolloutWorker_w1...
[2025-11-25 07:46:10,703][252775] Collected {0: 0}, FPS: 0.0
[2025-11-25 07:46:10,703][253137] Loop batcher_evt_loop terminating...
[2025-11-25 07:46:10,702][253156] Stopping RolloutWorker_w5...
[2025-11-25 07:46:10,703][253154] Loop rollout_proc2_evt_loop terminating...
[2025-11-25 07:46:10,703][253155] Loop rollout_proc4_evt_loop terminating...
[2025-11-25 07:46:10,703][253153] Stopping RolloutWorker_w3...
[2025-11-25 07:46:10,703][253157] Loop rollout_proc6_evt_loop terminating...
[2025-11-25 07:46:10,702][253158] Stopping RolloutWorker_w7...
[2025-11-25 07:46:10,703][253151] Loop rollout_proc0_evt_loop terminating...
[2025-11-25 07:46:10,703][253152] Loop rollout_proc1_evt_loop terminating...
[2025-11-25 07:46:10,704][253156] Loop rollout_proc5_evt_loop terminating...
[2025-11-25 07:46:10,704][253153] Loop rollout_proc3_evt_loop terminating...
[2025-11-25 07:46:10,704][253158] Loop rollout_proc7_evt_loop terminating...
[2025-11-25 07:46:10,759][253150] Weights refcount: 2 0
[2025-11-25 07:46:10,761][253150] Stopping InferenceWorker_p0-w0...
[2025-11-25 07:46:10,761][253150] Loop inference_proc0-0_evt_loop terminating...
